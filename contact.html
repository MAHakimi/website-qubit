<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Qubit Interactive - IPTV & Digital Signage Solutions for Hospitality" />
  <meta name="author" content="Qubit Asia" />
  <title>Contact Us | Qubit Asia </title>
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
:root {
  --primary-color: #FF6B00; /* Vibrant orange */
  --secondary-color: #E05A00; /* Darker orange */
  --accent-color: #FF8C42; /* Lighter orange accent */
  --light-color: #FFFFFF; /* Pure white */
  --dark-color: #1A1A1A; /* Dark black */
  --success-color: #4BB543;
  --warning-color: #FFA500;
  --error-color: #FF3333;
  --border-radius: 16px;
  --shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}
    /* General Styles */
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #F8F8F8, #EEEEEE);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      align-items: center;
    }

    .contact-container {
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
    }

    .contact-card {
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    @media (min-width: 768px) {
      .contact-card {
        flex-direction: row;
      }
    }

    /* Loading Overlay */
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.95);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .contact-info {
      background: linear-gradient(135deg, var(--dark-color), #2A2A2A);
      color: white;
      padding: 2.5rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .contact-info::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }

    .contact-info h2 {
      font-weight: 700;
      margin-bottom: 1.5rem;
      position: relative;
      padding-bottom: 1rem;
      z-index: 2;
    }

    .contact-info h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 4px;
      background-color: var(--accent-color);
      border-radius: 2px;
    }

    .contact-info p {
      opacity: 0.9;
      margin-bottom: 2rem;
      z-index: 2;
      position: relative;
    }

    .contact-details {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      z-index: 2;
      position: relative;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      transition: transform 0.3s ease;
    }

    .contact-item:hover {
      transform: translateX(5px);
    }

    .contact-icon {
      width: 50px;
      height: 50px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .contact-item:hover .contact-icon {
      background-color: var(--primary-color);
      color: white;
      transform: scale(1.1);
    }

    .contact-form-container {
      padding: 2.5rem;
      flex: 1.5;
      background-color: var(--light-color);

    }

    .contact-form h3 {
      font-weight: 600;
      margin-bottom: 2rem;
      color: var(--dark-color);
      position: relative;
      padding-bottom: 1rem;
    }

    .contact-form h3::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      border-radius: 2px;
    }

    /* Enhanced Form Fields */
    .form-group {
      margin-bottom: 1.5rem;
      position: relative;
    }

    .floating-label {
      position: relative;
      margin-bottom: 0.25rem; /* Reduced from 1.5rem */

    }

    .floating-label textarea {
  width: 100%;
  padding: 1rem 0.75rem;
  border: 1px solid #ccc;
  border-radius: 6px;
  outline: none;
  resize: vertical;
  min-height: 100px;
  background: #f9fff9; /* light background like your screenshot */
}

    .floating-label input,
    .floating-label textarea,
    .floating-label select {
      width: 100%;
      padding: 1rem 1rem 0.5rem 1rem;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      font-family: 'Poppins', sans-serif;
      font-size: 0.95rem;
      transition: all 0.3s ease;
      background-color: #fafafa;
    }

    .floating-label input:focus,
    .floating-label textarea:focus,
    .floating-label select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.1);
      background-color: white;
      outline: none;
    }

.floating-label label {
  position: absolute;
  top: 1rem;
  left: 0.75rem;
  color: #888;
  font-size: 1rem;
  pointer-events: none;
  transition: 0.2s ease all;
}

/* Move label up when focused or has text */
.floating-label textarea:focus + label,
.floating-label textarea:not(:placeholder-shown) + label {
  top: -0.6rem;
  left: 0.6rem;
  font-size: 0.8rem;
  color: green;
  background: #fff;
  padding: 0 0.25rem;
}
/* Add to your existing styles */
.form-control {
    padding-top: 1.25rem; /* More space for floating label */
    padding-bottom: 0.75rem;
    transition: all 0.2s ease;
}

.floating-label label {
    top: 0.75rem; /* Adjusted from 1rem */
    transition: all 0.2s ease;
}

.floating-label input:focus + label,
.floating-label textarea:focus + label,
.floating-label select:focus + label,
.floating-label input:not(:placeholder-shown) + label,
.floating-label textarea:not(:placeholder-shown) + label,
.floating-label select:not([value=""]) + label {
    top: 0.25rem;
    font-size: 0.7rem; /* Slightly smaller */
}

    textarea.form-control {
      min-height: 120px;
      resize: vertical;
    }

    /* Validation States */
    .form-group.valid .form-control {
      border-color: var(--success-color);
      background-color: #f8fff8;
    }

    .form-group.valid .floating-label label {
      color: var(--success-color);
    }

    .form-group.invalid .form-control {
      border-color: var(--error-color);
      background-color: #fff8f8;
    }

    .form-group.invalid .floating-label label {
      color: var(--error-color);
    }

.validation-message {
    font-size: 0.8rem;
    margin-top: 0.25rem;
    padding-left: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    height: 0;
    opacity: 0;
    transform: translateY(-5px);
    transition: all 0.3s ease;
    overflow: hidden;
}

.validation-message.show {
    height: auto;
    opacity: 1;
    transform: translateY(0);
    margin-bottom: 0.5rem; /* Add space below */
}



    .validation-message.success {
      color: var(--success-color);
    }

    .validation-message.error {
      color: var(--error-color);
    }

    /* Enhanced CAPTCHA */
    .captcha-container {
      background: linear-gradient(135deg, #FFF5F0, #FFEBE0);
      border: 2px solid #FFD5C0;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      position: relative;
    }

    .captcha-label {
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--dark-color);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .captcha-display {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
      background: white;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .captcha-text {
      font-family: 'Courier New', monospace;
      font-size: 1.8rem;
      font-weight: bold;
      letter-spacing: 4px;
      color: var(--dark-color);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
      user-select: none;
      position: relative;
    }

    .captcha-text::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(to right, transparent, var(--accent-color), transparent);
      transform: translateY(-50%);
      opacity: 0.3;
    }

    .refresh-captcha {
      background: var(--dark-color);
      border: none;
      color: white;
      padding: 0.75rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .refresh-captcha:hover {
      background: #333333;
      transform: scale(1.05);
    }

    .refresh-captcha:active {
      transform: scale(0.95);
    }

    .captcha-input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .captcha-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
      outline: none;
    }

    /* Enhanced Submit Button */
    .submit-btn {
      width: 100%;
      padding: 1rem;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border: none;
      color: white;
      font-weight: 600;
      font-size: 1rem;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      position: relative;
      overflow: hidden;
    }

    .submit-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }

    .submit-btn:hover {
      background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(67, 97, 238, 0.3);
    }

    .submit-btn:hover::before {
      left: 100%;
    }

    .submit-btn:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .submit-btn:disabled::before {
      display: none;
    }

    /* Timer Message */
    .timer-message {
      text-align: center;
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
      font-size: 0.9rem;
      display: none;
      background: linear-gradient(135deg, #fff3cd, #ffeaa7);
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .timer-message.error {
      background: linear-gradient(135deg, #f8d7da, #ffcccb);
      color: #721c24;
      border-color: #ffcccb;
    }

    /* Enhanced Success Modal */
    .success-modal .modal-content {
      border-radius: var(--border-radius);
      overflow: hidden;
      border: none;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .success-modal .modal-header {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border: none;
      padding: 2rem;
      text-align: center;
    }

    .success-modal .modal-body {
      padding: 3rem 2rem;
      text-align: center;
    }

    .success-icon {
      font-size: 5rem;
      color: var(--success-color);
      margin-bottom: 1.5rem;
      animation: bounce 0.8s ease-out;
    }

    @keyframes bounce {
      0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
      40%, 43% { transform: translate3d(0,-20px,0); }
      70% { transform: translate3d(0,-10px,0); }
      90% { transform: translate3d(0,-4px,0); }
    }

    .success-modal .modal-footer {
      border: none;
      display: flex;
      justify-content: center;
      padding-bottom: 2rem;
    }

    .success-btn {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border: none;
      padding: 0.75rem 2rem;
      border-radius: 50px;
      color: white;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .success-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1100;
    }

    .custom-toast {
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      border: none;
      min-width: 300px;
    }

    .toast-header {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border: none;
      border-radius: 12px 12px 0 0;
      padding: 1rem;
    }

    /* Responsive Design */
    @media (max-width: 767px) {
      body {
        padding: 10px;
      }
      
      .contact-info,
      .contact-form-container {
        padding: 2rem 1.5rem;
      }
      
      .captcha-text {
        font-size: 1.4rem;
        letter-spacing: 2px;
      }
      
      .contact-details {
        gap: 1rem;
      }
    }

    /* Accessibility Improvements */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Focus styles for better accessibility */
    button:focus,
    input:focus,
    textarea:focus,
    select:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    #captchaError {
    margin-top: 0.5rem;
    margin-bottom: 0;
    padding: 0.5rem;
    border-radius: 8px;
    background-color: rgba(255, 248, 248, 0.5);
}

#captchaError.success {
    background-color: rgba(248, 255, 248, 0.5);
}
  </style>
</head>
<body>
<div class="contact-container">
    <div class="contact-card">
        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay" role="status" aria-label="Loading">
            <div class="loading-spinner"></div>
            <span class="sr-only">Sending message...</span>
        </div>

<div class="contact-info">
  <h2>Get in Touch</h2>
  <p>Have questions about our IPTV & Digital Signage solutions? Fill out the form and our team will get back to you shortly.</p>
  
  <div class="contact-details">

    <!-- Location -->
    <div class="contact-item">
      <div class="contact-icon d-flex align-items-center justify-content-center">
        <i class="fas fa-map-marker-alt fa-lg"></i>
      </div>
      <div>
        <h5 class="mb-0">Location</h5>
        <p class="mb-0">Bandar Kinrara 5, 47180 Puchong</p>
      </div>
    </div>

    <!-- Phone -->
    <div class="contact-item">
      <div class="contact-icon d-flex align-items-center justify-content-center">
        <i class="fas fa-phone-alt fa-lg"></i>
      </div>
      <div>
        <h5 class="mb-0">Phone</h5>
        <p class="mb-0">+603-8075 0659</p>
      </div>
    </div>

    <!-- Email -->
    <div class="contact-item">
      <div class="contact-icon d-flex align-items-center justify-content-center">
        <i class="fas fa-envelope fa-lg"></i>
      </div>
      <div>
        <h5 class="mb-0">Email</h5>
        <p class="mb-0">hello@qubit.asia</p>
      </div>
    </div>

  </div>
</div>


        <!-- Contact Form -->
        <div class="contact-form-container">
            <form id="contactForm" class="contact-form" method="POST" novalidate>
                <h3>Send us a message</h3>

                <div class="form-group">
                    <div class="floating-label">
                        <input type="text" id="name" name="name" class="form-control" placeholder=" " required 
                               aria-describedby="nameValidation" minlength="2" maxlength="100">
                        <label for="name">Your Name *</label>
                    </div>
                    <div class="validation-message" id="nameValidation" role="alert" aria-live="polite"></div>
                </div>

                <div class="form-group">
                    <div class="floating-label">
                        <input type="email" id="email" name="email" class="form-control" placeholder=" " required 
                               aria-describedby="emailValidation" maxlength="255">
                        <label for="email">Your Email *</label>
                    </div>
                    <div class="validation-message" id="emailValidation" role="alert" aria-live="polite"></div>
                </div>

                <div class="form-group">
                    <div class="floating-label">
                        <select id="subject" name="subject" class="form-control" required aria-describedby="subjectValidation">
                            <option value="">Select a topic...</option>
                            <option value="iptv">IPTV Solutions</option>
                            <option value="digital-signage">Digital Signage</option>
                            <option value="support">Technical Support</option>
                            <option value="pricing">Pricing Inquiry</option>
                            <option value="partnership">Partnership Opportunity</option>
                            <option value="other">Other</option>
                        </select>
                        <label for="subject">Subject *</label>
                    </div>
                    <div class="validation-message" id="subjectValidation" role="alert" aria-live="polite"></div>
                </div>

                <div class="form-group">
                  <div class="floating-label">
                    <textarea id="message" name="message" class="form-control" 
                              placeholder=" " required 
                              aria-describedby="messageValidation" minlength="10" maxlength="1000"></textarea>
                    <!-- <label for="message">Your Message *</label> -->
                  </div>
                  <div class="validation-message" id="messageValidation" role="alert" aria-live="polite"></div>
                </div>

                <!-- Honeypot Field -->
                <input type="text" name="_honey" style="display:none" tabindex="-1" aria-hidden="true">

                <!-- Enhanced CAPTCHA -->
                <div class="captcha-container">
                    <div class="captcha-label">
                        <i class="fas fa-shield-alt" aria-hidden="true"></i>
                        Security Verification
                    </div>
                    <div class="captcha-display">
                        <span id="captchaText" class="captcha-text" aria-label="CAPTCHA text"></span>
                        <button type="button" id="refreshCaptcha" class="refresh-captcha" 
                                title="Generate new CAPTCHA" aria-label="Refresh CAPTCHA">
                            <i class="fas fa-sync-alt" aria-hidden="true"></i>
                        </button>
                    </div>
                    <input type="text" id="captchaInput" class="captcha-input" 
                           placeholder="Enter the text shown above" required autocomplete="off"
                           aria-describedby="captchaError" maxlength="6">
                    <div id="captchaError" class="validation-message" role="alert" aria-live="polite"></div>
                </div>

                <button type="submit" id="submitButton" class="submit-btn" aria-describedby="timerMessage">
                    <span id="submitText">Send Message</span>
                    <i class="fas fa-paper-plane" aria-hidden="true"></i>
                </button>

                <div id="timerMessage" class="timer-message" role="status" aria-live="polite">
                    Please wait <span id="countdown">15</span> seconds before submitting again.
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Toast Container -->
<div class="toast-container" aria-live="polite" aria-atomic="true"></div>

<!-- Success Modal -->
<div class="modal fade success-modal" id="thankYouModal" tabindex="-1" aria-hidden="true" aria-labelledby="modalTitle">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">Message Sent Successfully</h5>
            </div>
            <div class="modal-body">
                <div class="success-icon" aria-hidden="true">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h4>Thank You!</h4>
                <p>Your message has been sent successfully. Our team will get back to you within 24 hours.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="success-btn" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<!-- EmailJS -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
$(document).ready(function() {
    const form = $('#contactForm');
    const submitButton = $('#submitButton');
    const submitText = $('#submitText');
    const timerMessage = $('#timerMessage');
    const countdownElement = $('#countdown');
    const captchaText = $('#captchaText');
    const captchaInput = $('#captchaInput');
    const captchaError = $('#captchaError');
    const refreshCaptcha = $('#refreshCaptcha');
    const loadingOverlay = $('#loadingOverlay');

    let isSubmitting = false;
    let countdownInterval;
    let originalCaptcha = '';

    // Initialize EmailJS (Replace with your actual User ID)
    emailjs.init(""); // Replace with your actual EmailJS user ID


    // Enhanced CAPTCHA generation
    function generateCaptcha() {
        const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789';
        let result = '';
        for (let i = 0; i < 6; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        originalCaptcha = result;
        captchaText.text(result);
        captchaInput.val('');
        hideValidationMessage(captchaError);
        captchaInput.removeClass('is-invalid');
    }

    // Initialize CAPTCHA
    generateCaptcha();

    // Refresh CAPTCHA with animation
    refreshCaptcha.click(function() {
        $(this).find('i').addClass('fa-spin');
        setTimeout(() => {
            generateCaptcha();
            $(this).find('i').removeClass('fa-spin');
        }, 300);
    });

    // Enhanced validation functions
function validateField(field, validator, successMessage, errorMessage) {
    const value = field.val().trim();
    const formGroup = field.closest('.form-group');
    const validationDiv = formGroup.find('.validation-message');
    
    // Reset state
    formGroup.removeClass('valid invalid');
    hideValidationMessage(validationDiv);
    
    // Skip validation if empty and not submitted
    if (value === '' && !isSubmitting) return false;
    
    if (validator(value)) {
        formGroup.addClass('valid');
        showValidationMessage(validationDiv, successMessage, 'success');
        return true;
    } else {
        formGroup.addClass('invalid');
        showValidationMessage(validationDiv, errorMessage, 'error');
        return false;
    }
}
    function showValidationMessage(element, message, type) {
        const icon = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
        element.html(`<i class="${icon}" aria-hidden="true"></i> ${message}`)
               .removeClass('success error')
               .addClass(type + ' show');
    }

    function hideValidationMessage(element) {
        element.removeClass('show');
    }
// Track if fields have been touched
$('#name, #email, #message, #subject').data('touched', false);

// Name field validation
$('#name').on('blur', function() {
    $(this).data('touched', true);
    validateField(
        $(this), 
        value => value.length >= 2 && value.length <= 100 && /^[a-zA-Z\s.'-]+$/.test(value),
        'Name looks good!',
        'Please enter a valid name (2-100 characters)'
    );
}).on('input', function() {
    if ($(this).data('touched')) {
        validateField(
            $(this),
            value => value.length >= 2 && value.length <= 100 && /^[a-zA-Z\s.'-]+$/.test(value),
            'Name looks good!',
            'Please enter a valid name (2-100 characters)'
        );
    }
});

// Email field validation
$('#email').on('blur', function() {
    $(this).data('touched', true);
    validateField(
        $(this),
        value => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value) && value.length <= 255,
        'Email format is valid!',
        'Please enter a valid email address'
    );
}).on('input', function() {
    if ($(this).data('touched')) {
        validateField(
            $(this),
            value => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value) && value.length <= 255,
            'Email format is valid!',
            'Please enter a valid email address'
        );
    }
});

// Subject field validation
$('#subject').on('change', function() {
    $(this).data('touched', true);
    validateField(
        $(this),
        value => value !== '',
        'Subject selected!',
        'Please select a subject'
    );
});

// Message field validation
$('#message').on('blur', function() {
    $(this).data('touched', true);
    validateField(
        $(this),
        value => value.length >= 10 && value.length <= 1000,
        'Message looks good!',
        'Please enter a message between 10-1000 characters'
    );
}).on('input', function() {
    if ($(this).data('touched')) {
        validateField(
            $(this),
            value => value.length >= 10 && value.length <= 1000,
            'Message looks good!',
            'Please enter a message between 10-1000 characters'
        );
    }
});
    // CAPTCHA validation
    $('#captchaInput').on('input', function() {
        const userCaptcha = $(this).val().trim();
        if (userCaptcha.length === 6) {
            if (userCaptcha.toLowerCase() === originalCaptcha.toLowerCase()) {
                showValidationMessage(captchaError, 'CAPTCHA verified!', 'success');
            } else {
                showValidationMessage(captchaError, 'CAPTCHA does not match. Please try again.', 'error');
            }
        } else {
            hideValidationMessage(captchaError);
        }
    });

    // Enhanced countdown timer
    function startCountdown(seconds) {
        let remaining = seconds;
        countdownElement.text(remaining);
        timerMessage.removeClass('error').show();

        countdownInterval = setInterval(function() {
            remaining--;
            countdownElement.text(remaining);

            if (remaining <= 0) {
                clearInterval(countdownInterval);
                timerMessage.hide();
                isSubmitting = false;
                submitButton.prop('disabled', false);
                submitText.text('Send Message');
            }
        }, 1000);
    }

    // Show toast notification
    function showToast(message, type = 'success') {
        const toastId = 'toast-' + Date.now();
        const iconClass = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
        const bgClass = type === 'success' ? 'bg-success' : 'bg-danger';
        
        const toastHtml = `
            <div id="${toastId}" class="toast custom-toast" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="toast-header ${bgClass}">
                    <i class="${iconClass} me-2" aria-hidden="true"></i>
                    <strong class="me-auto">Notification</strong>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body">
                    ${message}
                </div>
            </div>
        `;
        
        $('.toast-container').append(toastHtml);
        const toast = new bootstrap.Toast(document.getElementById(toastId));
        toast.show();
        
        // Remove toast element after it's hidden
        document.getElementById(toastId).addEventListener('hidden.bs.toast', function() {
            this.remove();
        });
    }

// Send email via EmailJS
    function sendEmail(formData) {
    console.log('Attempting to send email with data:', formData);
    // Paste yout serviceID and TemplateID here
    return emailjs.send('', '', formData)
        .then(function(response) {
            console.log('Email sent successfully:', response);
            return response;
        })
        .catch(function(error) {
            // Add this enhanced error logging here
            console.error('Detailed error:', {
                status: error.status,
                text: error.text,
                message: error.message,
                stack: error.stack
            });
            throw error;
        });
}
    // Enhanced form submission
    form.submit(function(event) {
        event.preventDefault();

        // Check if already submitting
        if (isSubmitting) {
            timerMessage.addClass('error').show();
            return;
        }

        // Validate all fields
        const isNameValid = validateField($('#name'), 
            value => value.length >= 2 && value.length <= 100 && /^[a-zA-Z\s.'-]+$/.test(value),
            'Name looks good!',
            'Please enter a valid name (2-100 characters, letters only)'
        );

        const isEmailValid = validateField($('#email'),
            value => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value) && value.length <= 255,
            'Email format is valid!',
            'Please enter a valid email address'
        );

        const isSubjectValid = validateField($('#subject'),
            value => value !== '',
            'Subject selected!',
            'Please select a subject'
        );

        const isMessageValid = validateField($('#message'),
            value => value.length >= 10 && value.length <= 1000,
            'Message looks good!',
            'Please enter a message between 10-1000 characters'
        );

        // Validate CAPTCHA
        const userCaptcha = captchaInput.val().trim();
        let isCaptchaValid = false;
        
        if (userCaptcha.length === 0) {
            showValidationMessage(captchaError, 'Please enter the CAPTCHA text.', 'error');
        } else if (userCaptcha.toLowerCase() !== originalCaptcha.toLowerCase()) {
            showValidationMessage(captchaError, 'CAPTCHA does not match. Please try again.', 'error');
            captchaInput.focus();
        } else {
            showValidationMessage(captchaError, 'CAPTCHA verified!', 'success');
            isCaptchaValid = true;
        }

        // Check honeypot
        if ($('input[name="_honey"]').val() !== '') {
            showToast('Submission blocked for security reasons.', 'error');
            return;
        }

        // If any validation fails, scroll to first error
        if (!isNameValid || !isEmailValid || !isSubjectValid || !isMessageValid || !isCaptchaValid) {
            const firstError = $('.form-group.invalid').first();
            if (firstError.length) {
                firstError[0].scrollIntoView({ behavior: 'smooth', block: 'center' });
                firstError.find('input, textarea, select').first().focus();
            }
            return;
        }

        // Start submission process
        isSubmitting = true;
        submitButton.prop('disabled', true);
        submitText.text('Sending...');
        loadingOverlay.show();

        // Collect form data
        const formData = {
            name: $('#name').val().trim(),
            email: $('#email').val().trim(),
            subject: $('#subject option:selected').text(),
            message: $('#message').val().trim(),
            // timestamp: new Date().toISOString()
        };

        // Send email
        sendEmail(formData)
            .then(function(response) {
                // Success
                loadingOverlay.hide();
                
                // Show success modal
                const modal = new bootstrap.Modal($('#thankYouModal'));
                modal.show();

                // Show success toast
                showToast('Message sent successfully! We\'ll get back to you soon.', 'success');

                // Reset form
                form[0].reset();
                $('.form-group').removeClass('valid invalid');
                $('.validation-message').removeClass('show');
                
                // Generate new CAPTCHA
                generateCaptcha();

                // Start countdown timer (reduced to 15 seconds)
                startCountdown(15);

            })
            .catch(function(error) {
                // Error handling
                loadingOverlay.hide();
                submitButton.prop('disabled', false);
                submitText.text('Send Message');
                isSubmitting = false;

                console.error('Email send error:', error);
                
                // Show error toast with specific message
                let errorMessage = 'There was an issue sending your message. Please try again.';
                if (error.message.includes('network') || error.message.includes('Network')) {
                    errorMessage = 'Network error. Please check your connection and try again.';
                } else if (error.status === 429) {
                    errorMessage = 'Too many requests. Please wait a moment before trying again.';
                }
                
                showToast(errorMessage, 'error');
                
                // Generate new CAPTCHA for security
                generateCaptcha();
            });
    });

    // Enhanced keyboard navigation
    form.on('keydown', function(e) {
        if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
            e.preventDefault();
            const formElements = form.find('input:visible, select:visible, textarea:visible, button:visible');
            const currentIndex = formElements.index(e.target);
            const nextElement = formElements.eq(currentIndex + 1);
            
            if (nextElement.length) {
                nextElement.focus();
            } else {
                form.submit();
            }
        }
    });

    // Auto-resize textarea
    $('#message').on('input', function() {
        this.style.height = 'auto';
        this.style.height = Math.min(this.scrollHeight, 200) + 'px';
    });

    // Prevent form submission on Enter in CAPTCHA input
    $('#captchaInput').on('keydown', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            submitButton.focus();
        }
    });

    // Character counter for message field
    $('#message').after('<div class="char-counter text-muted mt-1" style="font-size: 0.8rem; text-align: right;"></div>');
    
    $('#message').on('input', function() {
        const currentLength = $(this).val().length;
        const maxLength = 1000;
        const counter = $(this).siblings('.char-counter');
        
        counter.text(`${currentLength}/${maxLength} characters`);
        
        if (currentLength > maxLength * 0.9) {
            counter.removeClass('text-muted').addClass('text-warning');
        } else {
            counter.removeClass('text-warning').addClass('text-muted');
        }
    });

    // Initialize character counter
    $('#message').trigger('input');

    // Accessibility: Announce form status changes
    function announceToScreenReader(message) {
        const announcement = $('<div class="sr-only" aria-live="polite" aria-atomic="true"></div>');
        announcement.text(message);
        $('body').append(announcement);
        setTimeout(() => announcement.remove(), 1000);
    }

    // Add form status announcements
    form.on('submit', function() {
        announceToScreenReader('Form submission in progress');
    });

    // Improve focus management for modal
    $('#thankYouModal').on('shown.bs.modal', function() {
        $(this).find('.success-btn').focus();
    });

    $('#thankYouModal').on('hidden.bs.modal', function() {
        $('#name').focus();
    });

    // Add subtle animations on scroll (if supported)
    if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        });

        $('.form-group').css({
            opacity: '0',
            transform: 'translateY(20px)',
            transition: 'all 0.3s ease'
        });

        $('.form-group').each(function() {
            observer.observe(this);
        });
    }


   
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // Form analytics (placeholder for actual analytics implementation)
    function trackEvent(action, category = 'Contact Form') {
        // Replace with actual analytics tracking
        console.log(`Analytics: ${category} - ${action}`);
        
        
    }

    // Track form interactions
    $('#name, #email, #subject, #message').on('focus', function() {
        trackEvent(`${this.name}_field_focused`);
    });

    form.on('submit', function() {
        trackEvent('form_submitted');
    });

    refreshCaptcha.on('click', function() {
        trackEvent('captcha_refreshed');
    });

    console.log('Enhanced Qubit Asia Contact Form initialized successfully!');
});
</script>

</body>
</html>